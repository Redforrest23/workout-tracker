<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1f1f1f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Workout">
    <title>Workout Tracker</title>

    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='180' height='180' viewBox='0 0 180 180'><rect width='180' height='180' fill='%231f1f1f'/><text x='50%' y='50%' font-size='80' text-anchor='middle' dominant-baseline='middle' fill='%23bb86fc'>ðŸ’ª</text></svg>">

    <!-- PWA Manifest embedded as data URL -->
    <link rel="manifest"
        href="data:application/json;base64,eyJuYW1lIjoiV29ya291dCBUcmFja2VyIiwic2hvcnRfbmFtZSI6IldvcmtvdXQiLCJzdGFydF91cmwiOiIvIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiIzEyMTIxMiIsInRoZW1lX2NvbG9yIjoiIzFmMWYxZiIsIm9yaWVudGF0aW9uIjoicG9ydHJhaXQiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxOTInIGhlaWdodD0nMTkyJyB2aWV3Qm94PScwIDAgMTkyIDE5MiclM0UlM0NyZWN0IHdpZHRoPScxOTInIGhlaWdodD0nMTkyJyBmaWxsPSclMjMxZjFmMWYnLyUzRSUzQ3RleHQgeD0nNTAlMjUnIHk9JzUwJTI1JyBmb250LXNpemU9JzgwJyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmaWxsPSclMjNiYjg2ZmMnJTNFJUYwJTlGJThCJUFBJTNDL3RleHQlM0UlM0Mvc3ZnJTNFIiwidHlwZSI6ImltYWdlL3N2Zyt4bWwiLCJzaXplcyI6IjE5MngxOTIifSx7InNyYyI6ImRhdGE6aW1hZ2Uvc3ZnK3htbCwlM0NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nNTEyJyBoZWlnaHQ9JzUxMicgdmlld0JveD0nMCAwIDUxMiA1MTInJTNFJTNDcmVjdCB3aWR0aD0nNTEyJyBoZWlnaHQ9JzUxMicgZmlsbD0nJTIzMWYxZjFmJy8lM0UlM0N0ZXh0IHg9JzUwJTI1JyB5PSc1MCUyNScgZm9udC1zaXplPScyNTAnIHRleHQtYW5jaG9yPSdtaWRkbGUnIGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZpbGw9JyUyM2JiODZmYyclM0UlRjAlOUYlOEIlQUElM0MvdGV4dCUzRSUzQy9zdmclM0UiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCIsInNpemVzIjoiNTEyeDUxMiJ9XX0=">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #121212;
            color: #fff;
            overflow-x: hidden;
        }

        /* Password Screen Styles */
        .password-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .password-container {
            background-color: #1e1e1e;
            border-radius: 12px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            border: 1px solid #333;
        }

        .password-title {
            font-size: 28px;
            font-weight: bold;
            color: #bb86fc;
            margin-bottom: 10px;
            text-align: center;
        }

        .password-subtitle {
            font-size: 14px;
            color: #ccc;
            margin-bottom: 30px;
            text-align: center;
        }

        .password-input {
            width: 100%;
            background-color: #2a2a2a;
            color: #fff;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            border: 1px solid #444;
            margin-bottom: 20px;
        }

        .password-input:focus {
            outline: none;
            border-color: #bb86fc;
        }

        .password-btn {
            width: 100%;
            background-color: #03dac6;
            padding: 15px;
            border-radius: 8px;
            border: none;
            color: #000;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
        }

        .password-btn:active {
            opacity: 0.8;
        }

        .password-error {
            color: #cf6679;
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
        }

        .password-hint {
            font-size: 12px;
            color: #888;
            margin-top: 20px;
            text-align: center;
            font-style: italic;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: #1f1f1f;
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #333;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-title {
            font-size: 24px;
            font-weight: bold;
            color: #bb86fc;
        }

        .header-date {
            font-size: 14px;
            color: #ccc;
            margin-top: 5px;
        }

        .streak {
            font-size: 16px;
            color: #03dac6;
            margin-top: 5px;
            font-weight: 600;
        }

        .refresh-btn {
            background-color: #333;
            border-radius: 25px;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: none;
            cursor: pointer;
            font-size: 24px;
            color: #bb86fc;
            margin: 10px auto 0;
        }

        .button-row {
            display: flex;
            justify-content: space-around;
            padding: 10px;
            background-color: #1a1a1a;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            color: #fff;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            flex: 1;
        }

        .settings-btn {
            background-color: #333;
        }

        .history-btn {
            background-color: #444;
        }

        .postpone-btn {
            background-color: #bb86fc;
            color: #000;
        }

        .workout-list {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 20px;
        }

        .card {
            background-color: #1e1e1e;
            margin: 10px;
            border-radius: 12px;
            padding: 15px;
            border: 1px solid #333;
        }

        .completed-card {
            opacity: 0.7;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .ex-info {
            flex: 1;
        }

        .ex-name {
            font-size: 18px;
            font-weight: bold;
            color: #fff;
        }

        .ex-cat {
            font-size: 12px;
            color: #bb86fc;
            margin-top: 2px;
        }

        .header-right {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }

        .diff-toggle {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .diff-label {
            font-size: 12px;
            color: #666;
        }

        .diff-label-active {
            color: #fff;
            font-weight: bold;
        }

        .toggle-switch {
            width: 40px;
            height: 20px;
            background-color: #03dac6;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .toggle-switch.hard {
            background-color: #cf6679;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: #fff;
            top: 2px;
            left: 2px;
            transition: left 0.3s;
        }

        .toggle-switch.hard::after {
            left: 22px;
        }

        .desc-btn {
            background-color: #333;
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            color: #03dac6;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
        }

        .reg-section {
            background-color: #1a1a1a;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .hard-section {
            background-color: #2a1a1a;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #cf6679;
        }

        .diff-title {
            font-size: 14px;
            font-weight: 600;
            color: #03dac6;
            margin-bottom: 10px;
        }

        .diff-title-hard {
            font-size: 14px;
            font-weight: 600;
            color: #cf6679;
            margin-bottom: 10px;
        }

        .set-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            gap: 10px;
        }

        .set-label {
            font-size: 14px;
            color: #ccc;
            width: 60px;
        }

        .input {
            flex: 1;
            background-color: #2a2a2a;
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            border: 1px solid #444;
        }

        .completed-set-value {
            flex: 1;
            color: #03dac6;
            font-size: 14px;
            font-weight: 600;
        }

        .complete-btn {
            background-color: #03dac6;
            padding: 12px;
            border-radius: 8px;
            border: none;
            color: #000;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
        }

        .complete-btn:disabled {
            background-color: #333;
            opacity: 0.5;
            color: #666;
            cursor: not-allowed;
        }

        .completed-divider {
            background-color: #2a2a2a;
            padding: 12px 15px;
            margin: 20px 10px 0;
            border-radius: 8px;
        }

        .completed-title {
            font-size: 18px;
            font-weight: bold;
            color: #03dac6;
            text-align: center;
        }

        .completed-text {
            color: #03dac6;
        }

        .completed-summary {
            font-size: 14px;
            color: #aaa;
            margin-top: 5px;
        }

        .rest-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
        }

        .rest-title {
            font-size: 28px;
            font-weight: bold;
            color: #03dac6;
            margin-bottom: 15px;
            text-align: center;
        }

        .rest-text {
            font-size: 16px;
            color: #ccc;
            text-align: center;
            line-height: 24px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background-color: #1e1e1e;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            border: 1px solid #444;
            display: flex;
            flex-direction: column;
        }

        .modal-full {
            width: 90%;
            height: 80vh;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #333;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            color: #bb86fc;
        }

        .modal-done {
            font-size: 16px;
            color: #03dac6;
            font-weight: 600;
            background: none;
            border: none;
            cursor: pointer;
        }

        .modal-scroll {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        /* Tab Styles */
        .tabs {
            display: flex;
            border-bottom: 1px solid #333;
            background-color: #1a1a1a;
        }

        .tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            color: #888;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            color: #bb86fc;
            border-bottom-color: #bb86fc;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .desc-modal-content {
            background-color: #1e1e1e;
            border-radius: 12px;
            padding: 20px;
            width: 85%;
            max-height: 70vh;
            border: 1px solid #444;
            overflow-y: auto;
        }

        .desc-title {
            font-size: 20px;
            font-weight: bold;
            color: #bb86fc;
            margin-bottom: 15px;
        }

        .desc-text {
            font-size: 14px;
            color: #ccc;
            line-height: 20px;
            margin-bottom: 15px;
        }

        .video-link-btn {
            background-color: #bb86fc;
            padding: 12px;
            border-radius: 8px;
            border: none;
            color: #000;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            margin-bottom: 15px;
        }

        .pdf-info-box {
            background-color: #2a2a2a;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #444;
        }

        .pdf-info-text {
            font-size: 14px;
            color: #03dac6;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .pdf-page-text {
            font-size: 13px;
            color: #fff;
            font-style: italic;
        }

        .pdf-link-btn {
            background-color: #03dac6;
            padding: 12px;
            border-radius: 8px;
            border: none;
            color: #000;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            margin-bottom: 15px;
        }

        .close-btn {
            background-color: #333;
            padding: 12px;
            border-radius: 8px;
            border: none;
            color: #fff;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
        }

        .cat-title {
            font-size: 16px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 10px;
            margin-top: 20px;
        }

        .cat-title:first-child {
            margin-top: 0;
        }

        .settings-subtitle {
            font-size: 12px;
            color: #888;
            margin-bottom: 10px;
            font-style: italic;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #2a2a2a;
        }

        .settings-name {
            font-size: 14px;
            color: #ccc;
            flex: 1;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .rest-day-selector {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .rest-day-label {
            font-size: 14px;
            color: #ccc;
            margin-bottom: 10px;
        }

        .rest-day-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .rest-day-option {
            background-color: #333;
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid #444;
            color: #ccc;
            font-size: 14px;
            cursor: pointer;
        }

        .rest-day-option.selected {
            background-color: #bb86fc;
            color: #000;
            border-color: #bb86fc;
        }

        .info-section {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .info-title {
            font-size: 16px;
            font-weight: bold;
            color: #bb86fc;
            margin-bottom: 8px;
        }

        .info-text {
            font-size: 14px;
            color: #ccc;
            line-height: 20px;
        }

        .empty-history {
            font-size: 14px;
            color: #888;
            text-align: center;
            margin-top: 30px;
        }

        .history-card {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #444;
            cursor: pointer;
        }

        .history-date {
            font-size: 16px;
            font-weight: bold;
            color: #03dac6;
            margin-bottom: 5px;
        }

        .history-type {
            font-size: 14px;
            color: #bb86fc;
            margin-bottom: 8px;
        }

        .history-exercises {
            font-size: 12px;
            color: #aaa;
            margin-bottom: 5px;
        }

        .tap-to-view {
            font-size: 11px;
            color: #666;
            font-style: italic;
            margin-top: 5px;
        }

        @media (max-width: 600px) {
            .header-title {
                font-size: 20px;
            }

            .card {
                margin: 10px 5px;
            }
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // CHANGE PASSWORD HERE - Make it whatever you want!
        const CORRECT_PASSWORD = "workout123";

        const DEFAULT_EXERCISES = {
            push: [
                { id: 'p1', name: 'Wall Push-ups', difficulty: 1, sets: 3, reps: 10, hardSets: 4, hardReps: 15, isTime: false, enabled: true, desc: 'Stand facing wall. Hands on wall at shoulder height. Lean in, push back. Keep body straight throughout.', videoUrl: 'https://www.hybridcalisthenics.com/wall-pushups' },
                { id: 'p2', name: 'Incline Push-ups', difficulty: 2, sets: 3, reps: 10, hardSets: 4, hardReps: 12, isTime: false, enabled: false, desc: 'Hands on elevated surface. Lower chest to surface, push up. Keep core tight, body in straight line.', videoUrl: 'https://www.hybridcalisthenics.com/incline-pushups' },
                { id: 'p3', name: 'Regular Push-ups', difficulty: 3, sets: 3, reps: 10, hardSets: 4, hardReps: 15, isTime: false, enabled: false, desc: 'Plank position. Lower chest to ground, elbows 45Â°. Push back up. Maintain straight body line.', videoUrl: 'https://www.hybridcalisthenics.com/full-pushups' },
                { id: 'p4', name: 'Diamond Push-ups', difficulty: 4, sets: 3, reps: 8, hardSets: 3, hardReps: 12, isTime: false, enabled: false, desc: 'Thumbs and index fingers form diamond. Keep elbows close. Targets triceps heavily.', videoUrl: null },
                { id: 'p5', name: 'Decline Push-ups', difficulty: 5, sets: 3, reps: 10, hardSets: 4, hardReps: 12, isTime: false, enabled: false, desc: 'Feet elevated. Hands on ground. Harder than regular push-ups. Emphasizes upper chest.', videoUrl: null },
                { id: 'p6', name: 'Archer Push-ups', difficulty: 6, sets: 3, reps: 6, hardSets: 3, hardReps: 10, isTime: false, enabled: false, desc: 'Wide hands. Lower to one side, other arm extends. Alternate sides. Advanced strength.', videoUrl: 'https://www.hybridcalisthenics.com/pushups' },
                { id: 'p7', name: 'One-Arm Push-up Progression', difficulty: 7, sets: 3, reps: 5, hardSets: 3, hardReps: 8, isTime: false, enabled: false, desc: 'Progress toward one-arm. Start wide stance. Gradually narrow. Ultimate push variation.', videoUrl: 'https://www.hybridcalisthenics.com/pushups' }
            ],
            pull: [
                { id: 'pu1', name: 'Wall Pull-ups', difficulty: 1, sets: 3, reps: 8, hardSets: 3, hardReps: 12, isTime: false, enabled: true, desc: 'Face wall, hands overhead. Walk feet forward, lean back. Pull toward wall using back.', videoUrl: null },
                { id: 'pu2', name: 'Australian Pull-ups', difficulty: 2, sets: 3, reps: 8, hardSets: 4, hardReps: 12, isTime: false, enabled: false, desc: 'Low bar. Hang underneath, body straight. Pull chest to bar. Lower with control.', videoUrl: 'https://www.hybridcalisthenics.com/pullups' },
                { id: 'pu3', name: 'Negative Pull-ups', difficulty: 3, sets: 3, reps: 5, hardSets: 3, hardReps: 8, isTime: false, enabled: false, desc: 'Jump to top position. Lower slowly (5-10 seconds). Builds strength for full pull-ups.', videoUrl: 'https://www.hybridcalisthenics.com/pullups' },
                { id: 'pu4', name: 'Assisted Pull-ups', difficulty: 4, sets: 3, reps: 6, hardSets: 3, hardReps: 10, isTime: false, enabled: false, desc: 'Use band or chair for assistance. Pull chin over bar. Focus on back muscles.', videoUrl: 'https://www.hybridcalisthenics.com/pullups' },
                { id: 'pu5', name: 'Regular Pull-ups', difficulty: 5, sets: 3, reps: 5, hardSets: 4, hardReps: 8, isTime: false, enabled: false, desc: 'Hang from bar, palms away. Pull chin over bar. Lower controlled. Engage core.', videoUrl: 'https://www.hybridcalisthenics.com/pullups' },
                { id: 'pu6', name: 'Chin-ups', difficulty: 5, sets: 3, reps: 6, hardSets: 4, hardReps: 10, isTime: false, enabled: false, desc: 'Palms facing you. Slightly easier. More bicep involvement. Pull chin over bar.', videoUrl: 'https://www.hybridcalisthenics.com/pullups' },
                { id: 'pu7', name: 'Wide Grip Pull-ups', difficulty: 6, sets: 3, reps: 5, hardSets: 3, hardReps: 8, isTime: false, enabled: false, desc: 'Hands wider than shoulders. Targets lats more. Harder than regular pull-ups.', videoUrl: 'https://www.hybridcalisthenics.com/pullups' },
                { id: 'pu8', name: 'Archer Pull-ups', difficulty: 7, sets: 3, reps: 4, hardSets: 3, hardReps: 6, isTime: false, enabled: false, desc: 'Pull to one hand, other extends. Very advanced. Builds one-arm pulling strength.', videoUrl: 'https://www.hybridcalisthenics.com/pullups' }
            ],
            squats: [
                { id: 'sq1', name: 'Assisted Squats', difficulty: 1, sets: 3, reps: 12, hardSets: 4, hardReps: 15, isTime: false, enabled: true, desc: 'Hold chair or wall. Squat down low as comfortable. Stand back up. Build strength.', videoUrl: 'https://www.hybridcalisthenics.com/squats' },
                { id: 'sq2', name: 'Regular Squats', difficulty: 2, sets: 3, reps: 15, hardSets: 4, hardReps: 20, isTime: false, enabled: false, desc: 'Feet shoulder-width. Lower hips back and down. Chest up. Knees track over toes.', videoUrl: 'https://www.hybridcalisthenics.com/squats' },
                { id: 'sq3', name: 'Close Stance Squats', difficulty: 3, sets: 3, reps: 12, hardSets: 4, hardReps: 15, isTime: false, enabled: false, desc: 'Feet close together. More balance challenge. Increased quad emphasis.', videoUrl: null },
                { id: 'sq4', name: 'Bulgarian Split Squats', difficulty: 4, sets: 3, reps: 10, hardSets: 3, hardReps: 12, isTime: false, enabled: false, desc: 'Back foot elevated. Front foot forward. Lower into lunge. Single-leg strength.', videoUrl: null },
                { id: 'sq5', name: 'Jump Squats', difficulty: 4, sets: 3, reps: 10, hardSets: 3, hardReps: 15, isTime: false, enabled: false, desc: 'Squat down, explode into jump. Land soft. Builds power and explosiveness.', videoUrl: null },
                { id: 'sq6', name: 'Assisted Pistol Squat', difficulty: 5, sets: 3, reps: 6, hardSets: 3, hardReps: 8, isTime: false, enabled: false, desc: 'One-leg with support. Other leg extended forward. Progress toward full pistol.', videoUrl: 'https://www.hybridcalisthenics.com/squats' },
                { id: 'sq7', name: 'Pistol Squats', difficulty: 6, sets: 3, reps: 5, hardSets: 3, hardReps: 8, isTime: false, enabled: false, desc: 'One leg, other extended. Squat on standing leg. Very challenging movement.', videoUrl: 'https://www.hybridcalisthenics.com/squats' },
                { id: 'sq8', name: 'Dragon Squats', difficulty: 7, sets: 3, reps: 20, hardSets: 3, hardReps: 30, isTime: true, enabled: false, desc: 'Deep squat on one leg, other extended to side. Hold. Advanced mobility and strength.', videoUrl: null }
            ],
            core: [
                { id: 'c1', name: 'Knee Raises', difficulty: 1, sets: 3, reps: 10, hardSets: 4, hardReps: 12, isTime: false, enabled: true, desc: 'Lie on back or hang. Bring knees to chest. Lower controlled. Beginner core.', videoUrl: null },
                { id: 'c2', name: 'Dead Bugs', difficulty: 2, sets: 3, reps: 10, hardSets: 3, hardReps: 15, isTime: false, enabled: false, desc: 'Back on ground. Extend opposite arm and leg. Alternate. Keep lower back pressed down.', videoUrl: null },
                { id: 'c3', name: 'Leg Raises', difficulty: 3, sets: 3, reps: 8, hardSets: 3, hardReps: 12, isTime: false, enabled: false, desc: 'Lie flat. Raise straight legs to 90Â°. Lower slowly. Don\'t let back arch.', videoUrl: null },
                { id: 'c4', name: 'Hanging Knee Raises', difficulty: 4, sets: 3, reps: 8, hardSets: 3, hardReps: 12, isTime: false, enabled: false, desc: 'Hang from bar. Bring knees to chest. Lower slow. Avoid swinging.', videoUrl: null },
                { id: 'c5', name: 'Hanging Leg Raises', difficulty: 5, sets: 3, reps: 6, hardSets: 3, hardReps: 10, isTime: false, enabled: false, desc: 'Hang from bar. Raise straight legs horizontal. Advanced core strength required.', videoUrl: null }
            ],
            mandatory: [
                { id: 'm1', name: 'Elephant Walks', sets: 2, reps: 10, hardSets: 3, hardReps: 15, isTime: false, enabled: true, desc: 'Stand, bend forward to touch toes. Alternate bending knees, lifting heels. Dynamic hamstring stretch. Prepares body for deeper stretching.', videoUrl: 'https://www.youtube.com/shorts/jDFH__6aRGQ' },
                { id: 'm2', name: 'Single Leg RDL', sets: 2, reps: 8, hardSets: 3, hardReps: 12, isTime: false, enabled: true, desc: 'Stand on one leg. Hinge at hip, reach down with opposite hand. Keep back straight. Other leg extends behind for balance. Hamstring and balance work.', videoUrl: 'https://www.youtube.com/shorts/jDFH__6aRGQ' },
                { id: 'm3', name: 'Pike Pull Stretch', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Sit or stand in pike position. Grab something stable (bar, pole, bench). Pull your head toward your feet. Deep hamstring and back stretch.', videoUrl: 'https://www.youtube.com/shorts/jDFH__6aRGQ' }
            ],
            apt: [
                { id: 'a1', name: 'Glute Bridges', sets: 3, reps: 12, hardSets: 4, hardReps: 15, isTime: false, enabled: true, desc: 'Lie on back, knees bent. Lift hips by squeezing glutes until straight line. Lower slow. Use glutes, not back.', videoUrl: null },
                { id: 'a2', name: 'Dead Bugs', sets: 3, reps: 10, hardSets: 3, hardReps: 15, isTime: false, enabled: true, desc: 'Back flat, arms up, knees 90Â°. Extend opposite limbs. Maintain posterior pelvic tilt throughout.', videoUrl: null },
                { id: 'a3', name: 'Plank with PPT', sets: 3, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Plank position. Tuck tailbone, engage abs. Squeeze glutes. Lower back should round slightly.', videoUrl: null },
                { id: 'a4', name: 'Couch Stretch', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Back knee against wall, shin vertical. Front foot forward. Upright torso, squeeze glutes. Deep hip flexor stretch.', videoUrl: null },
                { id: 'a5', name: 'RDLs', sets: 3, reps: 10, hardSets: 3, hardReps: 12, isTime: false, enabled: true, desc: 'Hip-width stance. Hinge at hips, push back. Keep back straight. Feel hamstring stretch. Stand by squeezing glutes.', videoUrl: null },
                { id: 'a6', name: 'Cat-Cow', sets: 3, reps: 10, hardSets: 3, hardReps: 15, isTime: false, enabled: true, desc: 'Hands and knees. Cat: round spine, tuck tail. Cow: arch back, lift tail. Focus on tucked position for APT.', videoUrl: null },
                { id: 'a7', name: 'Clamshells', sets: 3, reps: 15, hardSets: 4, hardReps: 20, isTime: false, enabled: true, desc: 'Side-lying, knees 90Â°. Keep feet touching, lift top knee. Lower slow. Works glutes and hip rotators.', videoUrl: null },
                { id: 'a8', name: 'Reverse Plank', sets: 3, reps: 20, hardSets: 3, hardReps: 30, isTime: true, enabled: true, desc: 'Sit, legs extended, hands behind. Lift hips straight. Squeeze glutes hard. Maintain posterior pelvic tilt.', videoUrl: null },
                { id: 'a9', name: 'Wall Pelvic Tilts', sets: 3, reps: 10, hardSets: 3, hardReps: 15, isTime: false, enabled: true, desc: 'Back against wall, feet forward. Press lower back flat to wall (posterior tilt). Release. Teaches movement pattern.', videoUrl: null },
                { id: 'a10', name: '90/90 Hip Lift', sets: 3, reps: 8, hardSets: 3, hardReps: 12, isTime: false, enabled: true, desc: 'Back on ground, feet on wall at 90Â°. Press back down, exhale fully, lift hips slightly. Advanced core control.', videoUrl: null },
                { id: 'a11', name: 'Band Hip Extension', sets: 3, reps: 12, hardSets: 3, hardReps: 15, isTime: false, enabled: true, desc: 'Band on ankle. Extend hip back by squeezing glute. Keep knee straight. Don\'t arch back.', videoUrl: null },
                { id: 'a12', name: 'Bird Dogs', sets: 3, reps: 10, hardSets: 3, hardReps: 12, isTime: false, enabled: true, desc: 'Hands and knees. Extend opposite arm and leg. Hold briefly. Keep hips level. Stability and control.', videoUrl: null },
                { id: 'a13', name: 'Pelvic Clock', sets: 2, reps: 8, hardSets: 3, hardReps: 10, isTime: false, enabled: true, desc: 'Lie on back, knees bent. Imagine clock on pelvis. Tilt through each hour. 12:00 is posterior tilt.', videoUrl: null },
                { id: 'a14', name: 'Side Plank', sets: 3, reps: 20, hardSets: 3, hardReps: 30, isTime: true, enabled: true, desc: 'Side-lying on elbow. Lift hips straight. Hold. Keep hips stacked. Optional: lift top leg.', videoUrl: null },
                { id: 'a15', name: 'Frog Stretch', sets: 2, reps: 45, hardSets: 3, hardReps: 60, isTime: true, enabled: true, desc: 'Hands and knees, spread knees wide. Push hips back, lower down. Opens hips, stretches adductors.', videoUrl: null },
                { id: 'a16', name: 'World\'s Greatest', sets: 2, reps: 5, hardSets: 3, hardReps: 8, isTime: false, enabled: true, desc: 'Lunge. Hands inside front foot. Drop elbow down. Rotate and reach up. Full-body mobility.', videoUrl: null },
                { id: 'a17', name: 'Band Hip Distraction', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Band at hip crease. Half-kneeling. Band pulls hip back. Rock forward gently. Advanced technique.', videoUrl: null },
                { id: 'a18', name: 'Child\'s Pose PPT', sets: 2, reps: 45, hardSets: 3, hardReps: 60, isTime: true, enabled: true, desc: 'Sit on heels, arms forward. Tuck tailbone posteriorly. Gently round lower back. Breathe deep.', videoUrl: null }
            ],
            stretches: {
                hipFlexor: [
                    { id: 'sh1', name: 'Kneeling Hip Flexor', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Kneel on one knee. Keep upright. Push hips forward. Squeeze glute of kneeling leg.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Hips-V2.pdf', pdfPage: 'Week 2 Day 2' },
                    { id: 'sh2', name: 'Couch Stretch', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Knee against wall. Shin vertical. Front foot forward. Upright torso. Squeeze glutes.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Hips-V2.pdf', pdfPage: 'Week 4 Day 1' },
                    { id: 'sh3', name: 'Frog Stretch', sets: 2, reps: 45, hardSets: 3, hardReps: 60, isTime: true, enabled: true, desc: 'Knees wide. Push hips back. Lower toward ground. Opens hips and adductors.', videoUrl: null, pdfUrl: null, pdfPage: null }
                ],
                hamstring: [
                    { id: 'sh4', name: 'Standing Hamstring', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Heel forward on elevated surface. Straight leg. Hinge at hips. Reach toward toes.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Hamstring-V2.pdf', pdfPage: 'Week 3 Day 3' },
                    { id: 'sh5', name: 'Seated Hamstring', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Sit, legs extended. Hinge at hips. Reach forward. Keep back straight.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Hamstring-V2.pdf', pdfPage: 'Week 1 Day 1' },
                    { id: 'sh6', name: 'Single-Leg Hamstring', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Sit with one leg extended. Other bent. Reach toward extended leg.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Hamstring-V2.pdf', pdfPage: 'Week 1 Day 1' }
                ],
                hipGlute: [
                    { id: 'sh7', name: 'Figure-4', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Lie on back. Cross ankle over knee. Pull thigh to chest. Stretches piriformis and glutes.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Hips-V2.pdf', pdfPage: 'Week 3 Day 3' },
                    { id: 'sh8', name: 'Pigeon Pose', sets: 2, reps: 45, hardSets: 3, hardReps: 60, isTime: true, enabled: true, desc: 'Front leg bent 90Â°. Back leg extended. Lower hips down. Deep glute stretch.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Hips-V2.pdf', pdfPage: 'Week 1 Day 1' },
                    { id: 'sh9', name: '90/90 Hip', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Both legs bent 90Â°. One internal, one external rotation. Lean forward. Hip mobility.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Hips-V2.pdf', pdfPage: 'Week 1 Day 2' }
                ],
                shoulder: [
                    { id: 'sh10', name: 'Shoulder Dislocates', sets: 2, reps: 10, hardSets: 3, hardReps: 12, isTime: false, enabled: true, desc: 'Hold band wide. Straight arms. Bring overhead and behind back. Return. Mobility drill.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/01/FS-Shoulders-V2.pdf', pdfPage: 'Week 3 Day 3' },
                    { id: 'sh11', name: 'Cross-Body Shoulder', sets: 2, reps: 20, hardSets: 3, hardReps: 30, isTime: true, enabled: true, desc: 'Pull arm across body. Keep shoulders down. Stretch back of shoulder.', videoUrl: null, pdfUrl: null, pdfPage: null },
                    { id: 'sh12', name: 'Wall Slides', sets: 2, reps: 10, hardSets: 3, hardReps: 15, isTime: false, enabled: true, desc: 'Back to wall. Arms in goal post. Slide up overhead. Keep contact with wall.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/01/FS-Shoulders-V2.pdf', pdfPage: 'Week 4 Day 1' }
                ],
                backSpine: [
                    { id: 'sh13', name: 'Cat-Cow', sets: 2, reps: 10, hardSets: 3, hardReps: 15, isTime: false, enabled: true, desc: 'Hands and knees. Alternate arching (cow) and rounding (cat). Mobilizes spine.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Spine-V2.pdf', pdfPage: 'Week 1 Day 1' },
                    { id: 'sh14', name: 'Child\'s Pose', sets: 2, reps: 45, hardSets: 3, hardReps: 60, isTime: true, enabled: true, desc: 'Sit on heels. Arms extended forward. Relax and breathe. Back and shoulder stretch.', videoUrl: null, pdfUrl: null, pdfPage: null },
                    { id: 'sh15', name: 'Cobra', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Face down. Push up through hands. Lift chest. Hips stay down. Extends spine.', videoUrl: null, pdfUrl: 'https://movementbydavid.com/wp-content/uploads/2025/02/FS-Spine-V2.pdf', pdfPage: 'Week 3 Day 2' }
                ],
                fullBody: [
                    { id: 'sh16', name: 'World\'s Greatest', sets: 2, reps: 5, hardSets: 3, hardReps: 8, isTime: false, enabled: true, desc: 'Lunge. Hands inside front foot. Elbow down. Rotate and reach up. Full mobility.', videoUrl: null, pdfUrl: null, pdfPage: null },
                    { id: 'sh17', name: 'Downward Dog', sets: 2, reps: 30, hardSets: 3, hardReps: 45, isTime: true, enabled: true, desc: 'Inverted V. Hands and feet down. Hips high. Push heels down. Full body stretch.', videoUrl: null, pdfUrl: null, pdfPage: null }
                ]
            }
        };

        const WEEK_SCHEDULE = {
            0: { name: 'Legs', focus: ['squats'], includeCore: false },
            1: { name: 'Push', focus: ['push'], includeCore: true },
            2: { name: 'Pull', focus: ['pull'], includeCore: false },
            3: { name: 'Legs', focus: ['squats'], includeCore: false },
            4: { name: 'Push', focus: ['push'], includeCore: true },
            5: { name: 'Pull', focus: ['pull'], includeCore: false },
            6: { name: 'Rest', focus: [], includeCore: false }
        };

        const DAYS_OF_WEEK = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

        // Password Screen Component
        function PasswordScreen({ onUnlock }) {
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (password === CORRECT_PASSWORD) {
                    localStorage.setItem('workoutAppAuthenticated', 'true');
                    onUnlock();
                } else {
                    setError('Incorrect password. Try again.');
                    setPassword('');
                }
            };

            return (
                <div className="password-screen">
                    <div className="password-container">
                        <div className="password-title">ðŸ’ª Workout Tracker</div>
                        <div className="password-subtitle">Enter password to continue</div>
                        <form onSubmit={handleSubmit}>
                            <input
                                type="password"
                                className="password-input"
                                placeholder="Enter password"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                autoFocus
                            />
                            <button type="submit" className="password-btn">
                                Unlock
                            </button>
                        </form>
                        {error && <div className="password-error">{error}</div>}
                        <div className="password-hint">Hint: Default is "workout123"</div>
                    </div>
                </div>
            );
        }

        function App() {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [exercises, setExercises] = useState(DEFAULT_EXERCISES);
            const [workout, setWorkout] = useState([]);
            const [completedWorkout, setCompletedWorkout] = useState([]);
            const [log, setLog] = useState({});
            const [hardMode, setHardMode] = useState({});
            const [showSettings, setShowSettings] = useState(false);
            const [activeSettingsTab, setActiveSettingsTab] = useState('exercises');
            const [showDesc, setShowDesc] = useState(false);
            const [showHistory, setShowHistory] = useState(false);
            const [selected, setSelected] = useState(null);
            const [date, setDate] = useState('');
            const [dayName, setDayName] = useState('');
            const [isRest, setIsRest] = useState(false);
            const [streak, setStreak] = useState(0);
            const [history, setHistory] = useState([]);
            const [lastStretchCats, setLastStretchCats] = useState([]);
            const [viewingHistoryWorkout, setViewingHistoryWorkout] = useState(null);
            const [showHistoryDetail, setShowHistoryDetail] = useState(false);
            const [workoutComplete, setWorkoutComplete] = useState(false);
            const [customRestDay, setCustomRestDay] = useState(6); // Default Saturday
            const [restDayPostponed, setRestDayPostponed] = useState(false);

            useEffect(() => {
                // Check if user is authenticated
                const authStatus = localStorage.getItem('workoutAppAuthenticated');
                if (authStatus === 'true') {
                    setIsAuthenticated(true);
                    loadData();
                }
            }, []);

            useEffect(() => {
                if (isAuthenticated) {
                    finishWorkout();
                }
            }, [workout, completedWorkout, isAuthenticated]);

            const loadData = () => {
                try {
                    // Load saved exercise settings
                    const savedExercises = localStorage.getItem('exerciseSettings');
                    if (savedExercises) {
                        setExercises(JSON.parse(savedExercises));
                    }

                    // Load custom rest day
                    const savedRestDay = localStorage.getItem('customRestDay');
                    if (savedRestDay !== null) {
                        setCustomRestDay(parseInt(savedRestDay));
                    }

                    // Load rest day postponed status
                    const postponedStatus = localStorage.getItem('restDayPostponed');
                    const postponedDate = localStorage.getItem('restDayPostponedDate');
                    const today = new Date().toDateString();

                    if (postponedStatus === 'true' && postponedDate === today) {
                        setRestDayPostponed(true);
                    } else {
                        // Clear postponed status if it's a new day
                        localStorage.removeItem('restDayPostponed');
                        localStorage.removeItem('restDayPostponedDate');
                        setRestDayPostponed(false);
                    }

                    const historyData = localStorage.getItem('workoutHistory');
                    const stretchData = localStorage.getItem('lastStretchCats');

                    if (historyData) {
                        const parsedHistory = JSON.parse(historyData);
                        setHistory(parsedHistory);
                        calculateStreak(parsedHistory);
                    }

                    if (stretchData) {
                        setLastStretchCats(JSON.parse(stretchData));
                    }

                    const d = new Date();
                    const day = d.getDay();
                    setDate(d.toDateString());

                    // Determine if today is rest day (considering postponement)
                    const actualRestDay = restDayPostponed && day === customRestDay ? customRestDay + 1 : customRestDay;
                    const isRestDay = day === actualRestDay % 7;

                    setIsRest(isRestDay);
                    setDayName(isRestDay ? 'Rest' : WEEK_SCHEDULE[day].name);

                    if (!isRestDay) {
                        const todayDateStr = d.toDateString();
                        const alreadyWorkedOut = historyData ? JSON.parse(historyData).some(h => h.date === todayDateStr) : false;

                        if (!alreadyWorkedOut) {
                            generateWorkout(day);
                        } else {
                            setWorkoutComplete(true);
                        }
                    }
                } catch (error) {
                    console.error('Error loading data:', error);
                }
            };

            const calculateStreak = (historyData) => {
                if (historyData.length === 0) {
                    setStreak(0);
                    return;
                }

                const today = new Date();
                today.setHours(0, 0, 0, 0);

                let currentStreak = 0;
                let checkDate = new Date(today);

                while (true) {
                    const dayOfWeek = checkDate.getDay();

                    // Skip rest days
                    if (dayOfWeek === customRestDay) {
                        checkDate.setDate(checkDate.getDate() - 1);
                        continue;
                    }

                    const dateStr = checkDate.toDateString();
                    const workedOut = historyData.some(h => h.date === dateStr);

                    if (workedOut) {
                        currentStreak++;
                        checkDate.setDate(checkDate.getDate() - 1);
                    } else {
                        break;
                    }

                    if (checkDate.getDay() === 0 && currentStreak > 0) {
                        break;
                    }
                }

                setStreak(currentStreak);
            };

            const generateWorkout = (dayNum) => {
                const schedule = WEEK_SCHEDULE[dayNum];
                const selected = [];

                // Add mandatory exercises on Mon/Wed/Fri (days 1, 3, 5)
                if (dayNum === 1 || dayNum === 3 || dayNum === 5) {
                    const mandatoryEnabled = exercises.mandatory.filter(e => e.enabled);
                    for (const ex of mandatoryEnabled) {
                        selected.push({ ...ex, category: 'Mobility' });
                    }
                }

                for (const category of schedule.focus) {
                    const enabled = exercises[category].filter(e => e.enabled);
                    if (enabled.length > 0) {
                        selected.push({ ...enabled[0], category: schedule.name });
                    }
                }

                if (schedule.includeCore) {
                    const enabledCore = exercises.core.filter(e => e.enabled);
                    if (enabledCore.length > 0) {
                        selected.push({ ...enabledCore[0], category: 'Core' });
                    }
                }

                const aptEnabled = exercises.apt.filter(e => e.enabled);
                const numAPT = Math.floor(Math.random() * 2) + 2;
                const aptCopy = [...aptEnabled];
                for (let i = 0; i < Math.min(numAPT, aptCopy.length); i++) {
                    const idx = Math.floor(Math.random() * aptCopy.length);
                    selected.push({ ...aptCopy[idx], category: 'APT' });
                    aptCopy.splice(idx, 1);
                }

                const availableCats = Object.keys(exercises.stretches).filter(
                    cat => !lastStretchCats.includes(cat)
                );

                const stretchPool = [];
                for (const cat of availableCats) {
                    stretchPool.push(...exercises.stretches[cat].filter(e => e.enabled));
                }

                const numStretches = Math.floor(Math.random() * 2) + 2;
                const stretchCopy = [...stretchPool];
                const usedCats = [];

                for (let i = 0; i < Math.min(numStretches, stretchCopy.length); i++) {
                    const idx = Math.floor(Math.random() * stretchCopy.length);
                    const stretch = stretchCopy[idx];
                    selected.push({ ...stretch, category: 'Stretch' });

                    for (const [catName, catExercises] of Object.entries(exercises.stretches)) {
                        if (catExercises.some(e => e.id === stretch.id)) {
                            if (!usedCats.includes(catName)) {
                                usedCats.push(catName);
                            }
                        }
                    }

                    stretchCopy.splice(idx, 1);
                }

                setLastStretchCats(usedCats);
                localStorage.setItem('lastStretchCats', JSON.stringify(usedCats));

                setWorkout(selected);
                setCompletedWorkout([]);
                setLog({});
                setHardMode({});
                setWorkoutComplete(false);
            };

            const saveWorkoutToHistory = () => {
                try {
                    const d = new Date();
                    const workoutData = {
                        date: d.toDateString(),
                        workoutType: dayName,
                        exercises: [...workout, ...completedWorkout].map(ex => {
                            const isHard = hardMode[ex.id];
                            const prefix = isHard ? 'hard' : 'reg';
                            const numSets = isHard ? ex.hardSets : ex.sets;
                            const loggedSets = [];

                            for (let i = 0; i < numSets; i++) {
                                loggedSets.push(log[`${ex.id}-${prefix}-${i}`] || '0');
                            }

                            return {
                                ...ex,
                                isHard: isHard,
                                loggedSets: loggedSets
                            };
                        })
                    };

                    const updatedHistory = [...history, workoutData];
                    setHistory(updatedHistory);
                    localStorage.setItem('workoutHistory', JSON.stringify(updatedHistory));

                    calculateStreak(updatedHistory);
                    setWorkoutComplete(true);
                } catch (error) {
                    console.error('Error saving workout:', error);
                }
            };

            const finishWorkout = () => {
                if (workout.length === 0 && completedWorkout.length > 0 && !workoutComplete) {
                    saveWorkoutToHistory();
                }
            };

            const toggleEx = (category, id) => {
                setExercises(prev => {
                    const updated = JSON.parse(JSON.stringify(prev));
                    if (category === 'apt') {
                        const ex = updated.apt.find(e => e.id === id);
                        if (ex) ex.enabled = !ex.enabled;
                    } else if (category === 'mandatory') {
                        const ex = updated.mandatory.find(e => e.id === id);
                        if (ex) ex.enabled = !ex.enabled;
                    } else if (category === 'stretches') {
                        for (const subcat of Object.keys(updated.stretches)) {
                            const ex = updated.stretches[subcat].find(e => e.id === id);
                            if (ex) {
                                ex.enabled = !ex.enabled;
                                break;
                            }
                        }
                    } else {
                        const ex = updated[category].find(e => e.id === id);
                        if (ex) ex.enabled = !ex.enabled;
                    }
                    // Save to localStorage
                    localStorage.setItem('exerciseSettings', JSON.stringify(updated));
                    return updated;
                });
            };

            const logRep = (id, setIdx, value) => {
                setLog({ ...log, [`${id}-${setIdx}`]: value });
            };

            const toggleHardMode = (id) => {
                setHardMode({ ...hardMode, [id]: !hardMode[id] });
            };

            const isComplete = (ex) => {
                const isHard = hardMode[ex.id];
                const numSets = isHard ? ex.hardSets : ex.sets;
                const prefix = isHard ? 'hard' : 'reg';
                for (let i = 0; i < numSets; i++) {
                    if (!log[`${ex.id}-${prefix}-${i}`] || log[`${ex.id}-${prefix}-${i}`].trim() === '') {
                        return false;
                    }
                }
                return true;
            };

            const completeExercise = (ex) => {
                setWorkout(prev => prev.filter(e => e.id !== ex.id));
                setCompletedWorkout(prev => [...prev, ex]);
            };

            const viewDesc = (ex) => {
                setSelected(ex);
                setShowDesc(true);
            };

            const openVideo = (url) => {
                window.open(url, '_blank');
            };

            const postponeRestDay = () => {
                if (window.confirm('Move rest day to tomorrow? You can do today\'s workout instead.')) {
                    setRestDayPostponed(true);
                    localStorage.setItem('restDayPostponed', 'true');
                    localStorage.setItem('restDayPostponedDate', new Date().toDateString());

                    // Reload to generate today's workout
                    window.location.reload();
                }
            };

            const changeRestDay = (day) => {
                setCustomRestDay(day);
                localStorage.setItem('customRestDay', day.toString());
            };

            // Show password screen if not authenticated
            if (!isAuthenticated) {
                return <PasswordScreen onUnlock={() => setIsAuthenticated(true)} />;
            }

            if (isRest) {
                return (
                    <div className="container">
                        <div className="header">
                            <div className="header-title">Rest Day</div>
                            <div className="header-date">{date}</div>
                            <div className="streak">Streak: {streak} days</div>
                        </div>

                        <div className="button-row">
                            <button onClick={() => setShowSettings(true)} className="btn settings-btn">Settings</button>
                            <button onClick={() => setShowHistory(true)} className="btn history-btn">History</button>
                            <button onClick={postponeRestDay} className="btn postpone-btn">Postpone Rest</button>
                        </div>

                        <div className="rest-container">
                            <div className="rest-title">{DAYS_OF_WEEK[new Date().getDay()]} Rest Day</div>
                            <div className="rest-text">Recovery is when you get stronger. Rest up for tomorrow!</div>
                        </div>

                        {renderModals()}
                    </div>
                );
            }

            if (workoutComplete) {
                return (
                    <div className="container">
                        <div className="header">
                            <div className="header-title">{dayName} Day</div>
                            <div className="header-date">{date}</div>
                            <div className="streak">Streak: {streak} days</div>
                        </div>

                        <div className="button-row">
                            <button onClick={() => setShowSettings(true)} className="btn settings-btn">Settings</button>
                            <button onClick={() => setShowHistory(true)} className="btn history-btn">History</button>
                        </div>

                        <div className="workout-list">
                            <div style={{ textAlign: 'center', padding: '20px' }}>
                                <div className="rest-title">Workout Complete!</div>
                                <div className="rest-text">Great work today. Come back tomorrow for your next workout.</div>
                            </div>

                            <div className="cat-title" style={{ paddingLeft: '15px', paddingRight: '15px' }}>Today's Completed Workout</div>

                            {completedWorkout.map((ex) => {
                                const isHard = hardMode[ex.id];
                                const numSets = isHard ? ex.hardSets : ex.sets;
                                const reps = isHard ? ex.hardReps : ex.reps;
                                const prefix = isHard ? 'hard' : 'reg';

                                return (
                                    <div key={ex.id} className="card">
                                        <div className="card-header">
                                            <div className="ex-info">
                                                <div className="ex-name">âœ“ {ex.name}</div>
                                                <div className="ex-cat">{ex.category}</div>
                                            </div>
                                        </div>
                                        <div className={isHard ? 'hard-section' : 'reg-section'}>
                                            <div className={isHard ? 'diff-title-hard' : 'diff-title'}>
                                                {isHard ? 'Hard' : 'Regular'}: {numSets} sets Ã— {reps} {ex.isTime ? 'sec' : 'reps'}
                                            </div>
                                            {Array.from({ length: numSets }).map((_, i) => (
                                                <div key={i} className="set-row">
                                                    <div className="set-label">Set {i + 1}:</div>
                                                    <div className="completed-set-value">{log[`${ex.id}-${prefix}-${i}`] || '0'} {ex.isTime ? 'sec' : 'reps'}</div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>

                        {renderModals()}
                    </div>
                );
            }

            const renderModals = () => (
                <>
                    {/* Settings Modal */}
                    <div className={`modal ${showSettings ? 'show' : ''}`}>
                        <div className="modal-content modal-full">
                            <div className="modal-header">
                                <div className="modal-title">Settings</div>
                                <button onClick={() => setShowSettings(false)} className="modal-done">Done</button>
                            </div>

                            <div className="tabs">
                                <button
                                    className={`tab ${activeSettingsTab === 'exercises' ? 'active' : ''}`}
                                    onClick={() => setActiveSettingsTab('exercises')}
                                >
                                    Exercises
                                </button>
                                <button
                                    className={`tab ${activeSettingsTab === 'restday' ? 'active' : ''}`}
                                    onClick={() => setActiveSettingsTab('restday')}
                                >
                                    Rest Day
                                </button>
                                <button
                                    className={`tab ${activeSettingsTab === 'about' ? 'active' : ''}`}
                                    onClick={() => setActiveSettingsTab('about')}
                                >
                                    About
                                </button>
                            </div>

                            <div className="modal-scroll">
                                {/* Exercises Tab */}
                                <div className={`tab-content ${activeSettingsTab === 'exercises' ? 'active' : ''}`}>
                                    <div className="cat-title">Mandatory Mobility (3x per week)</div>
                                    <div className="settings-subtitle">These exercises automatically appear Mon/Wed/Fri</div>
                                    {exercises.mandatory.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('mandatory', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Push Exercises</div>
                                    {exercises.push.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('push', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Pull Exercises</div>
                                    {exercises.pull.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('pull', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Squats</div>
                                    {exercises.squats.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('squats', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Core</div>
                                    {exercises.core.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('core', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">APT</div>
                                    {exercises.apt.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('apt', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Hip Flexor Stretches</div>
                                    {exercises.stretches.hipFlexor.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('stretches', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Hamstring Stretches</div>
                                    {exercises.stretches.hamstring.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('stretches', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Hip/Glute Stretches</div>
                                    {exercises.stretches.hipGlute.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('stretches', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Shoulder Stretches</div>
                                    {exercises.stretches.shoulder.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('stretches', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Back/Spine Stretches</div>
                                    {exercises.stretches.backSpine.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('stretches', ex.id)}
                                            />
                                        </div>
                                    ))}

                                    <div className="cat-title">Full Body Stretches</div>
                                    {exercises.stretches.fullBody.map(ex => (
                                        <div key={ex.id} className="settings-row">
                                            <div className="settings-name">{ex.name}</div>
                                            <input
                                                type="checkbox"
                                                className="checkbox"
                                                checked={ex.enabled}
                                                onChange={() => toggleEx('stretches', ex.id)}
                                            />
                                        </div>
                                    ))}
                                </div>

                                {/* Rest Day Tab */}
                                <div className={`tab-content ${activeSettingsTab === 'restday' ? 'active' : ''}`}>
                                    <div className="info-section">
                                        <div className="info-title">Rest Day Configuration</div>
                                        <div className="info-text">
                                            Choose which day of the week should be your rest day. You can also postpone rest day by one day using the "Postpone Rest" button on rest days.
                                        </div>
                                    </div>

                                    <div className="rest-day-selector">
                                        <div className="rest-day-label">Select Rest Day:</div>
                                        <div className="rest-day-options">
                                            {DAYS_OF_WEEK.map((day, idx) => (
                                                <div
                                                    key={idx}
                                                    className={`rest-day-option ${customRestDay === idx ? 'selected' : ''}`}
                                                    onClick={() => changeRestDay(idx)}
                                                >
                                                    {day}
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="info-section" style={{ marginTop: '20px' }}>
                                        <div className="info-title">Current Schedule</div>
                                        <div className="info-text">
                                            {DAYS_OF_WEEK.map((day, idx) => {
                                                if (idx === customRestDay) {
                                                    return <div key={idx}><strong>{day}:</strong> Rest Day ðŸ’¤</div>;
                                                } else {
                                                    return <div key={idx}><strong>{day}:</strong> {WEEK_SCHEDULE[idx].name} Day ðŸ’ª</div>;
                                                }
                                            })}
                                        </div>
                                    </div>
                                </div>

                                {/* About Tab */}
                                <div className={`tab-content ${activeSettingsTab === 'about' ? 'active' : ''}`}>
                                    <div className="info-section">
                                        <div className="info-title">Workout Tracker</div>
                                        <div className="info-text">
                                            A progressive workout tracker with automatic daily workout generation based on a Push/Pull/Legs split schedule.
                                        </div>
                                    </div>

                                    <div className="info-section">
                                        <div className="info-title">Features</div>
                                        <div className="info-text">
                                            â€¢ Automatic daily workout generation<br />
                                            â€¢ Regular and Hard mode for each exercise<br />
                                            â€¢ Workout history and streak tracking<br />
                                            â€¢ Customizable exercise selection<br />
                                            â€¢ Configurable rest days<br />
                                            â€¢ APT correction exercises<br />
                                            â€¢ Mandatory mobility work (3x/week)<br />
                                            â€¢ Progressive overload tracking
                                        </div>
                                    </div>

                                    <div className="info-section">
                                        <div className="info-title">How It Works</div>
                                        <div className="info-text">
                                            Each day, the app generates a workout based on your schedule. Complete all sets and reps, then mark exercises as complete. Your workout history and streak are automatically tracked.
                                        </div>
                                    </div>

                                    <div className="info-section">
                                        <div className="info-title">Data Storage</div>
                                        <div className="info-text">
                                            All data is stored locally on your device. Your workout history, settings, and preferences are saved in your browser's local storage.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* History Modal */}
                    <div className={`modal ${showHistory ? 'show' : ''}`}>
                        <div className="modal-content modal-full">
                            <div className="modal-header">
                                <div className="modal-title">Workout History</div>
                                <button onClick={() => setShowHistory(false)} className="modal-done">Done</button>
                            </div>
                            <div className="modal-scroll">
                                {history.length === 0 ? (
                                    <div className="empty-history">No workout history yet.</div>
                                ) : (
                                    [...history].reverse().map((h, idx) => (
                                        <div
                                            key={idx}
                                            className="history-card"
                                            onClick={() => {
                                                setViewingHistoryWorkout(h);
                                                setShowHistory(false);
                                                setShowHistoryDetail(true);
                                            }}
                                        >
                                            <div className="history-date">{h.date}</div>
                                            <div className="history-type">{h.workoutType} Day</div>
                                            <div className="history-exercises">
                                                {h.exercises.map(e => e.name).join(', ')}
                                            </div>
                                            <div className="tap-to-view">Tap to view details</div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>
                    </div>

                    {/* History Detail Modal */}
                    <div className={`modal ${showHistoryDetail ? 'show' : ''}`}>
                        <div className="modal-content modal-full">
                            <div className="modal-header">
                                <div className="modal-title">{viewingHistoryWorkout?.workoutType} Day</div>
                                <button
                                    onClick={() => {
                                        setShowHistoryDetail(false);
                                        setViewingHistoryWorkout(null);
                                    }}
                                    className="modal-done"
                                >
                                    Close
                                </button>
                            </div>
                            <div className="modal-scroll">
                                {viewingHistoryWorkout?.exercises?.map((ex, idx) => {
                                    const numSets = ex.isHard ? ex.hardSets : ex.sets;
                                    const reps = ex.isHard ? ex.hardReps : ex.reps;

                                    return (
                                        <div key={idx} className="card">
                                            <div className="card-header">
                                                <div className="ex-info">
                                                    <div className="ex-name">{ex.name}</div>
                                                    <div className="ex-cat">{ex.category}</div>
                                                </div>
                                            </div>
                                            <div className={ex.isHard ? 'hard-section' : 'reg-section'}>
                                                <div className={ex.isHard ? 'diff-title-hard' : 'diff-title'}>
                                                    {ex.isHard ? 'Hard' : 'Regular'}: {numSets} sets Ã— {reps} {ex.isTime ? 'sec' : 'reps'}
                                                </div>
                                                {ex.loggedSets?.map((logged, i) => (
                                                    <div key={i} className="set-row">
                                                        <div className="set-label">Set {i + 1}:</div>
                                                        <div className="completed-set-value">{logged} {ex.isTime ? 'sec' : 'reps'}</div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    </div>

                    {/* Description Modal */}
                    <div className={`modal ${showDesc ? 'show' : ''}`}>
                        <div className="desc-modal-content">
                            <div className="desc-title">{selected?.name}</div>
                            {selected?.videoUrl ? (
                                <>
                                    <div className="desc-text">{selected?.desc}</div>
                                    <button onClick={() => openVideo(selected.videoUrl)} className="video-link-btn">
                                        ðŸ“¹ Watch Tutorial Video
                                    </button>
                                </>
                            ) : selected?.pdfUrl ? (
                                <>
                                    <div className="desc-text">{selected?.desc}</div>
                                    <div className="pdf-info-box">
                                        <div className="pdf-info-text">ðŸ“„ Find video tutorial in PDF:</div>
                                        <div className="pdf-page-text">{selected?.pdfPage}</div>
                                    </div>
                                    <button onClick={() => openVideo(selected.pdfUrl)} className="pdf-link-btn">
                                        Open PDF Guide
                                    </button>
                                </>
                            ) : (
                                <div className="desc-text">{selected?.desc}</div>
                            )}
                            <button onClick={() => setShowDesc(false)} className="close-btn">
                                Close
                            </button>
                        </div>
                    </div>
                </>
            );

            return (
                <div className="container">
                    <div className="header">
                        <div className="header-title">{dayName} Day</div>
                        <div className="header-date">{date}</div>
                        <div className="streak">Streak: {streak} days</div>
                    </div>

                    <button
                        onClick={() => {
                            if (window.confirm('This will generate a new workout for today. Your current progress will be lost. Continue?')) {
                                const d = new Date();
                                generateWorkout(d.getDay());
                            }
                        }}
                        className="refresh-btn"
                    >
                        â†»
                    </button>

                    <div className="button-row">
                        <button onClick={() => setShowSettings(true)} className="btn settings-btn">Settings</button>
                        <button onClick={() => setShowHistory(true)} className="btn history-btn">History</button>
                    </div>

                    <div className="workout-list">
                        {workout.map((ex) => {
                            const isHard = hardMode[ex.id];
                            const numSets = isHard ? ex.hardSets : ex.sets;
                            const reps = isHard ? ex.hardReps : ex.reps;
                            const complete = isComplete(ex);
                            const prefix = isHard ? 'hard' : 'reg';

                            return (
                                <div key={ex.id} className="card">
                                    <div className="card-header">
                                        <div className="ex-info">
                                            <div className="ex-name">{ex.name}</div>
                                            <div className="ex-cat">{ex.category}</div>
                                        </div>
                                        <div className="header-right">
                                            <div className="diff-toggle">
                                                <span className={`diff-label ${!isHard ? 'diff-label-active' : ''}`}>Reg</span>
                                                <div
                                                    className={`toggle-switch ${isHard ? 'hard' : ''}`}
                                                    onClick={() => toggleHardMode(ex.id)}
                                                />
                                                <span className={`diff-label ${isHard ? 'diff-label-active' : ''}`}>Hard</span>
                                            </div>
                                            <button onClick={() => viewDesc(ex)} className="desc-btn">
                                                Info
                                            </button>
                                        </div>
                                    </div>

                                    <div className={isHard ? 'hard-section' : 'reg-section'}>
                                        <div className={isHard ? 'diff-title-hard' : 'diff-title'}>
                                            {isHard ? 'Hard' : 'Regular'}: {numSets} sets Ã— {reps} {ex.isTime ? 'sec' : 'reps'}
                                        </div>
                                        {Array.from({ length: numSets }).map((_, i) => (
                                            <div key={i} className="set-row">
                                                <div className="set-label">Set {i + 1}:</div>
                                                <input
                                                    type="number"
                                                    className="input"
                                                    placeholder={ex.isTime ? 'Seconds' : 'Reps'}
                                                    value={log[`${ex.id}-${prefix}-${i}`] || ''}
                                                    onChange={(e) => logRep(`${ex.id}-${prefix}`, i, e.target.value)}
                                                />
                                            </div>
                                        ))}
                                    </div>

                                    <button
                                        onClick={() => complete && completeExercise(ex)}
                                        className="complete-btn"
                                        disabled={!complete}
                                    >
                                        Mark Complete
                                    </button>
                                </div>
                            );
                        })}

                        {completedWorkout.length > 0 && (
                            <>
                                <div className="completed-divider">
                                    <div className="completed-title">Completed</div>
                                </div>
                                {completedWorkout.map((ex) => {
                                    const isHard = hardMode[ex.id];
                                    const numSets = isHard ? ex.hardSets : ex.sets;
                                    const reps = isHard ? ex.hardReps : ex.reps;

                                    return (
                                        <div key={ex.id} className="card completed-card">
                                            <div className="card-header">
                                                <div className="ex-info">
                                                    <div className="ex-name completed-text">âœ“ {ex.name}</div>
                                                    <div className="ex-cat completed-text">{ex.category}</div>
                                                </div>
                                            </div>
                                            <div className="completed-summary">
                                                {isHard ? 'Hard' : 'Regular'}: {numSets} sets Ã— {reps} {ex.isTime ? 'sec' : 'reps'}
                                            </div>
                                        </div>
                                    );
                                })}
                            </>
                        )}
                    </div>

                    {renderModals()}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>

</html>